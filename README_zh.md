## RC 范围测量与校准

为解决左右摇杆刻度不一致（例如：左摇杆 1500→2000 仅 2 个刻度、右摇杆约 3.1 个刻度），新增 `test_RC/test_RC.ino`：

- 功能：使用中断在引脚 `2`（右）和 `3`（左）测量 PWM 宽度，打印每通道的 `raw`（最新/最小/最大）以及按通道校准后的 `norm`（归一化到 1000–2000）。
- 使用方法：
	- 上传后打开串口 `115200`，在各刻度与极限位置来回拨动，观察每秒打印。
	- 记录 `min/mid/max`（mid 为中心刻度附近的值）。
	- 当前示例校准：右 `min=1435, mid=1493, max=1994`；左 `min=1498, mid=1529, max=2006`。
	- 归一化策略：以中心为分界，`min→mid`映射到 `1000→1500`，`mid→max`映射到 `1500→2000`，保证中心稳定、两侧拉伸。

### 何时需要发射机（RC 控制器）端调整

当某通道在较少刻度范围内就达到 `2000 µs` 上限时，Arduino 无法“增加”该通道的物理分辨率。应在发射机侧进行通道设置：

- 端点/行程（Endpoints/ATV/Travel）：增大达到上限较快的通道，或统一两边的行程，使同样刻度跨度对应相近的 PWM 范围。
- 中点/微调（Subtrim/Center）：确保两通道中心均在约 `1500 µs`。
- 速率/指数（Dual Rates/Expo）：测试阶段建议关闭或统一，避免非线性导致刻度不一致。
- 输出范围（如支持）：统一到 `1000–2000 µs`。
- 遵循发射机的 Stick/Channel 校准流程，重新标定各轴。

完成发射机校准后，请用 `test_RC.ino` 再测一次并更新校准常量；随后我们会把同样的 per-channel 归一化应用到 `test/test.ino` 与 `wifi_RC_control/wifi_RC_control.ino`，确保档位与物理刻度严格对齐。
# Arduino 双推进器控制

[English](./README.md)

这是一个用于控制双推进器（左/右）的 Arduino 项目，支持多种控制模式。

## 项目结构

- **original/** - 原始 RC 遥控器控制版本
- **ros_control/** - ROS + RC 混合控制版本
- **wifi_control/** - WiFi 控制版本（开发中）

## 功能特性

### Original（原始版本）
- 读取 RX 遥控器的 PWM 信号
- 有效范围：950-2000 µs，映射到 ESC 范围 1100-1900 µs
- 中心位置死区控制
- 超时保护：200ms 无信号自动停止

### ROS Control（ROS 控制版本）
- 支持 RC 遥控器和 ROS 混合控制
- 通过 USB Serial 接收 ROS 命令
- 命令格式：`C <left_us> <right_us>\n`
- ROS 命令超时后自动切换回 RC 控制
- 实时状态输出：`S <mode> <outL> <outR>\n`

### WiFi Control（WiFi 控制版本）
- 开发中...

## 硬件连接

### 引脚定义
- **CH_LEFT_IN**: Pin 2 - 左通道 PWM 输入
- **CH_RIGHT_IN**: Pin 3 - 右通道 PWM 输入
- **ESC_LEFT_OUT**: Pin 9/10 - 左 ESC 信号输出
- **ESC_RIGHT_OUT**: Pin 10/9 - 右 ESC 信号输出

## 使用说明

1. 使用 Arduino IDE 打开对应的 `.ino` 文件
2. 选择正确的开发板型号
3. 连接 Arduino 到电脑
4. 上传程序

## 参数配置

- **RX 有效范围**: 950-2000 µs
- **ESC 输出范围**: 1100-1900 µs
- **中心位置**: 1500 µs
- **死区**: 50 µs
- **超时时间**: 200 ms

## 安全特性

- 输入信号超时自动停止
- 输入范围检查
- 中心死区保护

## 开发环境

- Arduino UNO WiFi R4
- Arduino IDE
- 所需库：Servo.h

## 许可

[添加许可信息]
